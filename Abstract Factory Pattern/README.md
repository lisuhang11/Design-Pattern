要创建一个王国，我们需要具有共同组织的对象。精灵王国需要一个精灵国王，精灵城堡和精灵军队，而 

兽人王国需要一个兽人国王，兽人城堡和兽人军队。王国中的对象之间存在依赖关系。

![类图](/images/class.jpg)

# 抽象工厂模式

**TIP**：**抽象工厂模式是否符合开闭原则？

**“开闭原则”的倾斜性**

对于涉及到多个产品族与多个产品等级结构的系统，其功能增强包括两方面：

* 增加产品族：**对于增加新的产品族，抽象工厂模式很好地支持了“开闭原则”，只需要增加具体产品并 

对应增加一个新的具体工厂，对已有代码无须做任何修改。

* 增加新的产品等级结构：**对于增加新的产品等级结构，需要修改所有的工厂角色，包括抽象工厂 

类，在所有的工厂类中都需要增加生产新产品的方法，违背了“开闭原则”。

## 主要优点

* 抽象工厂模式隔离了具体类的生成，使得客户并不需要知道什么被创建。**由于这种隔离，更换一个 

具体工厂就变得相对容易，所有的具体工厂都实现了抽象工厂中定义的那些公共接口，因此只需改 

变具体工厂的实例，就可以在某种程度上改变整个软件系统的行为。 

* 当一个**产品族中的多个对象被设计成一起**工作时，它能够保证客户端始终**只使用同一个产品族中的** 

**对象**。 

* **增加新的产品族**很方便，无须修改已有系统，**符合开闭原则**。

## 主要缺点

* **增加新的产品等级结构**麻烦，需要对原有系统进行较大的修改，甚至需要修改抽象层代码，这显然 

会带来较大的不便，**违背了****“****开闭原则****”**。

## 适用环境

在以下情况下可以考虑使用抽象工厂模式：

* 一个系统不应当依赖于产品类实例如何被创建、组合和表达的细节，这对于所有类型的工厂模式都 

是很重要的，**用户无须关心对象的创建过程，将对象的创建和使用解耦。** 

* **系统中有多于一个的产品族，而每次只使用其中某一产品族。**可以通过配置文件等方式来使得用户 

可以动态改变产品族，也可以很方便地增加新的产品族。 

* **属于同一个产品族的产品将在一起使用，这一约束必须在系统的设计中体现出来**。同一个产品族中 

的产品可以是没有任何关系的对象，但是它们都具有一些共同的约束，如同一操作系统下的按钮和 

文本框，按钮与文本框之间没有直接关系，但它们都是属于某一操作系统的，此时具有一个共同的 

约束条件：操作系统的类型。 

* **产品等级结构稳定**，设计完成之后，不会向系统中增加新的产品等级结构或者删除已有的产品等级 

结构。

